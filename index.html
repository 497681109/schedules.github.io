<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å“¥å“¥çš„ç­æ¬¡è¡¨</title>
    <style>
        /* æ ·å¼éƒ¨åˆ†ä¿æŒä¸å˜ */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }

        label {
            display: inline-block;
            margin-bottom: 10px;
        }

        input[type="date"] {
            padding: 5px;
            margin-bottom: 20px;
        }
        .picker{
            background: #EDF2FA;
            padding: 10px !important;
            border:1px solid #EDF2FA;
            outline:none;
        }

        #annual-shift-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
        }

        .month-table {
            border-collapse: collapse;
            margin: 10px;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .month-table caption {
            font-weight: bold;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 5px 5px 0 0;
        }

        .month-table th,
        .month-table td {
            border: 1px solid #ddd;
            padding: 12px;
            min-width: 50px;
            text-align: center;
            vertical-align: middle;
            transition: all 0.3s ease;
        }

        .month-table th {
            background: #f8f9fa;
        }

        .weekend {
            background-color: #EDF2FA;
        }

        .shift {
            font-size: 0.9em;
            color: #666;
            display: block;
            margin-top: 5px;
        }

        #shift-result {
            margin: 15px 0;
            font-size: 1.1em;
            color: #333;
        }
        
        .selected-date {
            background-color: #F9D8D8 !important;
            position: relative;
            animation: pulse 0.5s ease;
        }
        
        .selected-date::after {
            content: 'â¤';
            color: #FF6B6B;
            position: absolute;
            right: 2px;
            top: 2px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>å“¥å“¥çš„ç­è¡¨ğŸ’•</h1>
    <label for="date-picker">å¿«é€ŸæŸ¥è¯¢æ—¥æœŸï¼š</label>
    <input class="picker" type="date" id="date-picker" min="2025-01-01" max="2035-12-31">
    <div id="shift-result"></div>
    <div id="annual-shift-container"></div>

    <script>
        const festivals = {
            '2025-01-01': 'å…ƒæ—¦',
            '2025-01-28': 'é™¤å¤•',
            '2025-01-29': 'æ˜¥èŠ‚',
            '2025-02-12': 'å…ƒå®µèŠ‚',
            '2025-02-14': 'æƒ…äººèŠ‚',
            '2025-04-04': 'æ¸…æ˜èŠ‚',
            '2025-05-01': 'åŠ³åŠ¨èŠ‚',
            '2025-05-20': 'çºªå¿µæ—¥',
            '2025-05-31': 'ç«¯åˆèŠ‚',
            '2025-09-28': 'ç”Ÿæ—¥',
            '2025-10-01': 'å›½åº†èŠ‚',
            '2025-10-06': 'ä¸­ç§‹èŠ‚'
        };

        const festivalWishes = {
            'å…ƒæ—¦': ["æ–°å¹´ç¬¬ä¸€å¤©è¦å’Œæœ€çˆ±çš„å“¥å“¥ä¸€èµ·è¿‡å‘€ï½ğŸ‰", "å…ƒæ°”æ»¡æ»¡è¿æ–°å¹´ï¼ä»Šæ™šåƒå¤§é¤åº†ç¥å§ğŸ·"],
            'é™¤å¤•': ["é™¤å¤•å®ˆå²ä¸åœ¨å®¶è¦è§†é¢‘è¿çº¿å“¦ï¼ç­‰å“¥å“¥å›å®¶åƒå¹´å¤œé¥­ğŸ®", "çˆ†ç«¹å£°ä¸­ä¸€å²é™¤ï¼Œå“¥å“¥åˆè€ä¸€å²å•¦ğŸ˜"],
            'æ˜¥èŠ‚': ["æ˜¥èŠ‚å¿«ä¹ï¼ç»™æˆ‘å“¥å“¥æ‹œå¹´å•¦ğŸ§§ æ­å–œå‘è´¢çº¢åŒ…æ‹¿æ¥", "æ–°å¹´è¦æ›´çˆ±ä½ çš„è€å©†å“¦ï¼æ­å–œå‘è´¢çº¢åŒ…æ‹¿æ¥ğŸ’°"],
            'å…ƒå®µèŠ‚': ["å…ƒå®µèŠ‚è¦åƒç”œç”œçš„æ±¤åœ†ï¼Œå¾—å¤§å¤§çš„å…ƒå®ğŸ’‹", "èŠ±ç¯å†ç¾ä¹Ÿæ¯”ä¸ä¸Šå“¥å“¥çš„çœ¼ç›âœ¨"],
            'æƒ…äººèŠ‚': ["èŠ‚æ—¥å¿«ä¹å–”~ å“¥å“¥ï¼Œä»Šå¤©è¦å’Œæœ€ç¾ä¸½å¯çˆ±çš„è€å©†ä¸€èµ·è¿‡å‘€ğŸ’‹", "èŠ‚æ—¥å¿«ä¹å–”~ å“¥å“¥ï¼Œä»Šå¤©è¦å’Œæœ€ç¾ä¸½å¯çˆ±çš„è€å©†ä¸€èµ·è¿‡å‘€âœ¨"],
            'æ¸…æ˜èŠ‚': ["æ¸…æ˜æ—¶èŠ‚é›¨çº·çº·ï¼Œä½ æ¥ä¸‹ä¸€å¥ğŸ‘©â¤ï¸ğŸ’‹ğŸ‘¨", "å‡ºå»è¸é’èµèŠ±æŠŠï¼Œå¸Œæœ›æ˜¯ä¸ªå¥½å¤©æ°”å‘¢ğŸŒ¸"],
            'åŠ³åŠ¨èŠ‚': ["åŠ³åŠ¨æœ€å…‰è£ï¼ä½†ä»Šå¤©è¦å¥½å¥½ä¼‘æ¯å‘€ğŸ’†â™‚ï¸", "äº”ä¸€å‡æœŸå¸¦æˆ‘å‡ºå»ç©å§ğŸ¡"],
            'çºªå¿µæ—¥': [`åœ¨ä¸€èµ·ç¬¬${Math.floor((new Date() - new Date("2020-05-20")) / 86400000)}å¤©å•¦ï½ğŸ’•,ä»Šå¤©çš„æˆ‘ä»¬æ˜¯ä¸æ˜¯å»é¢†è¯äº†å‘¢ï¼Œå“‡å–”~ ä¸€ç›´å¹¸ç¦ä¸‹å»`],
            'ç«¯åˆèŠ‚': ["ä»Šå¤©è¯¥åƒç”œç”œçš„ç²½å­å•¦ï¼Œä¸Šå¤œç­çš„å“¥å“¥ä»Šå¤©ä¹Ÿè¦åƒç²½å­å–”ğŸ‹", "ç«¯åˆèŠ‚å•¦ï¼Œå¯æƒœä»Šå¤©è¦ä¸Šå¤œç­ï¼Œç•™æˆ‘åœ¨å®¶é»˜é»˜è¿‡èŠ‚ğŸ©¹"],
            'ç”Ÿæ—¥': ["æˆ‘äº²çˆ±çš„å“¥å“¥ï¼Œç”Ÿæ—¥å¿«ä¹å–”ï¼åˆé•¿å¤§ä¸€å²å•¦ï¼Œç°åœ¨æ˜¯ä¸ªæˆç†Ÿé­…åŠ›ç”·äººå•¦ğŸ‘¨", "æˆ‘äº²çˆ±çš„å“¥å“¥ï¼Œç”Ÿæ—¥å¿«ä¹å–”ï¼åˆé•¿å¤§ä¸€å²å•¦ï¼Œç°åœ¨æ˜¯ä¸ªæˆç†Ÿé­…åŠ›ç”·äººå•¦ğŸ‘¨"],
            'å›½åº†èŠ‚': ["å›½åº†å‡æœŸè¯¥å¸¦æˆ‘å‡ºå»ç©å•¦ï¼èµ°å•Š~å»äº«å—è‡ªç”±çš„é£", "ä¸ºç¥–å›½åº†ç”Ÿçš„åŒæ—¶ä¹Ÿè¦åº†ç¥æˆ‘ä»¬çš„çˆ±æƒ…ğŸ’‘"],
            'ä¸­ç§‹èŠ‚': ["æœˆåœ†äººå›¢åœ†ï¼Œå“¦è±~åˆä¸Šå¤œç­å•¦ ä¸‹ç­äº†èµæœˆğŸŒ• ", "å“¦è±~åˆä¸Šå¤œç­å•¦ï¼Œæœˆé¥¼åˆ†ä½ ä¸€åŠğŸ’"]
        };

        const sweetSentences = [
            "å“¥å“¥ä»Šå¤©ä¹Ÿè¦å…ƒæ°”æ»¡æ»¡å“¦ï¼è®°å¾—æƒ³æˆ‘ï½ğŸ’•",
            "å“‡ï¼Œè¿™ä¸ªç­æ¬¡ä¸é”™å˜›ï¼ä¸‹ç­å¸¦å¥½åƒçš„å›æ¥å‘€ï½ğŸ˜‹",
            "è®¤çœŸå·¥ä½œçš„å“¥å“¥æœ€å¸…äº†ï¼å¥–åŠ±ä½ å“ˆçŒ«ä¸€åª å“ˆå“ˆğŸ’†â™‚ï¸",
            "å¤œç­è¦æ³¨æ„èº«ä½“å‘€ï¼Œä¸‹ç­äº†è¦åƒç‚¹å®µå¤œğŸ± ä¸èƒ½é¥¿è‚šå­å–”",
            "ä¼‘æ¯çš„æ—¥å­è¦å¥½å¥½ä¼‘æ¯å“¦ï½ğŸ›Œ",
            "æ—©ç­æ—¥å‡ºå¥½æµªæ¼«ğŸŒ„ï¼Œä¸‹ç­å›å®¶è¦å¥½å¥½è¡¥çŒç¡å–”",
            "è¿™ä¸ªç­è¡¨å®‰æ’æ·±å¾—æœ•å¿ƒï¼Œèµæ—©ç‚¹ä¸‹ç­ğŸ˜˜",
            "ä¸Šç­ä¸è®¸çœ‹ğŸ‘€æ¼‚äº®å¦¹å¦¹ï¼ä¸ç„¶å›å®¶åªèƒ½åƒæˆ‘ä¸€æ‹³",
            "ä»Šå¤©åˆæ˜¯ä¸ºå°å®¶å¥‹æ–—çš„ä¸€å¤©å‘¢ï¼ŒåŠ æ²¹é¸­ï¼ğŸ¦†",
            "ç™½ç­è™½ç„¶è¾›è‹¦ï¼Œä½†æœ‰æˆ‘åœ¨ç­‰ä½ å›å®¶ğŸ ",
            `çŒœçŒœæ˜å¤©ä»€ä¹ˆæ—¥å­ï¼Ÿæ˜¯æˆ‘ä»¬ç›¸é‡çš„ç¬¬${Math.floor((new Date()-new Date("2020-05-20")))/86400000}å¤©å‘€ï½`,
            "æˆ‘ä»¬çš„å£å·æ˜¯å‘å®¶è‡´å¯Œï¼Œä¹°åˆ«å¢…ï¼ŒåŠ æ²¹é¸­ï¼ğŸ¦†",
            "ææŒ‡ä¸€ç®—ä»Šå¤©åˆæ˜¯ä¸€ä¸ªå‘è´¢çš„å¥½æ—¥å­ï¼Œå“‡å“ˆå“ˆå“ˆ",
        ];

        const shiftOrder = ['ä¼‘æ¯', 'ç™½ç­', 'å¤œç­', 'æ—©ç­'];
        const startYear = 2025;
        const baseDate = new Date('2025-01-01');

        function updateHighlight(dateString) {
            document.querySelectorAll('.selected-date').forEach(cell => {
                cell.classList.remove('selected-date');
            });

            const targetCells = document.querySelectorAll(`[data-date="${dateString}"]`);
            targetCells.forEach(cell => {
                cell.classList.add('selected-date');
                void cell.offsetWidth;
                cell.style.animation = 'pulse 0.5s ease';
            });
        }

        document.getElementById('date-picker').addEventListener('change', function() {
            const selectedDate = new Date(this.value);
            const dateString = this.value;
            
            const diffDays = Math.floor((selectedDate - baseDate) / (1000 * 3600 * 24));
            const shiftIndex = (diffDays % shiftOrder.length + shiftOrder.length) % shiftOrder.length;
            const shift = shiftOrder[shiftIndex];

            updateHighlight(dateString);

            const filtered = sweetSentences.filter(s => s.includes(shift));
            const available = filtered.length ? filtered : sweetSentences;
            const randomIndex = Math.floor(Math.random() * available.length);
            const daysSinceMeeting = Math.floor((new Date() - new Date('2020-05-20')) / 86400000);
            let message = available[randomIndex].replace(/\${days}/g, daysSinceMeeting);

            if(festivals[dateString]) {
                const festival = festivals[dateString];
                const wishes = festivalWishes[festival];
                message = wishes[Math.floor(Math.random()*wishes.length)];
            }

            document.getElementById('shift-result').innerHTML = 
                `ğŸ“…${dateString} ç­æ¬¡ï¼š${shift}<br>ğŸ’Œ${message}`;
        });

        function generateCalendar() {
            const container = document.getElementById('annual-shift-container');
            let overallDiffDays = 0;
            
            for (let month = 0; month < 12; month++) {
                const table = document.createElement('table');
                table.className ='month-table';

                const caption = table.createCaption();
                caption.textContent = new Date(startYear, month).toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: 'long'
                });

                const headerRow = table.insertRow();
                ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'].forEach(day => {
                    const th = document.createElement('th');
                    th.textContent = day;
                    headerRow.appendChild(th);
                });

                const firstDay = new Date(startYear, month, 1);
                const lastDay = new Date(startYear, month + 1, 0);
                let currentDate = new Date(firstDay);

                let row = table.insertRow();

                for (let i = 0; i < firstDay.getDay(); i++) {
                    row.insertCell();
                }

                while (currentDate <= lastDay) {
                    if (row.cells.length === 7) {
                        row = table.insertRow();
                    }

                    const cell = row.insertCell();
                    const day = currentDate.getDate();
                    const shiftIndex = overallDiffDays % shiftOrder.length; 
                    const shift = shiftOrder[shiftIndex];

                    if ([0, 6].includes(currentDate.getDay())) {
                        cell.classList.add('weekend');
                    }

                    // ä¿®å¤æ—¥æœŸç”Ÿæˆé€»è¾‘
                    const year = currentDate.getFullYear();
                    const m = String(currentDate.getMonth() + 1).padStart(2, '0');
                    const d = String(currentDate.getDate()).padStart(2, '0');
                    const dateStr = `${year}-${m}-${d}`;
                    cell.dataset.date = dateStr;

                    cell.innerHTML = `
                        <div>${day}</div>
                        <div class="shift">${shift}</div>
                    `;

                    currentDate.setDate(currentDate.getDate() + 1);
                    overallDiffDays++;
                }

                while (row.cells.length < 7) {
                    row.insertCell();
                }

                container.appendChild(table);
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            generateCalendar();
            
            const today = new Date();
            const minDate = new Date('2025-01-01');
            const defaultDate = today >= minDate ? today : minDate;
            const dateString = defaultDate.toISOString().split('T')[0];
            
            document.getElementById('date-picker').value = dateString;
            document.getElementById('date-picker').dispatchEvent(new Event('change'));
        });
    </script>
</body>
</html>
